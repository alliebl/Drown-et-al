---
title: "Drown et al. Chameleon Antipredator Stats"
author: "Drown, Liebl & Anderson"
date: "12/17/2021"
output: html_document
---


```{r}
#setwd("~/Thesis/Stats & Measurements")
GGchameleon2=read.csv("Chameleon_Measurements_v3.csv")
attach(GGchameleon2)
#View(GGchameleon2)
```


log-transforming necessary variables
```{r}
log.bite=log(max.bite.force)
log.SVL=log(SVL)
log.HL=log(HL)
log.HH=log(HH)
log.CH=log(CH)
log.LJL=log(LJL)
log.HW=log(HW)
log.CW=log(CW)
log.JW=log(JW)
```



PCA of Color Change Data
```{r}
if(!require(devtools)) install.packages("devtools")
if(!require(factoextra)) install_github("kassambara/factoextra")
if(!require(ggbiplot)) install_github("vqv/ggbiplot")
library(factoextra)
library(ggbiplot)
library(nlme)

JNDData<- read.csv("Chameleon Color JNDs.csv") 
summary(JNDData)


BluetitJNDPCA<- prcomp(JNDData[,c(2:8)], center = TRUE, scale. = TRUE)
summary(BluetitJNDPCA)
str(BluetitJNDPCA)
fviz_eig(BluetitJNDPCA) #Visualizes how much of the variation each PC value accounts for
ggbiplot(BluetitJNDPCA,ellipse=TRUE, groups=JNDData$Subspecies)
ggbiplot(BluetitJNDPCA,ellipse=TRUE, var.axes=FALSE, groups=JNDData$Subspecies)
#PC1to4BluetitJNDPCAResults<-BluetitJNDPCA$x[,1:4]


BluetitPCA<-as.data.frame(BluetitJNDPCA$x) #create datasheet
GGchameleon2$BirdPC1<-BluetitPCA$PC1 #add PC1 from Bluetit PCA to datasheet

GartersnakeJNDPCA<- prcomp(JNDData[,c(9:15)], center = TRUE, scale. = TRUE)
summary(GartersnakeJNDPCA)
str(GartersnakeJNDPCA)
fviz_eig(GartersnakeJNDPCA) #Visualizes how much of the variation each PC value accounts for
ggbiplot(GartersnakeJNDPCA,ellipse=TRUE, groups=JNDData$Subspecies)
ggbiplot(GartersnakeJNDPCA,ellipse=TRUE, var.axes=FALSE, groups=JNDData$Subspecies)
#PC1to4GartersnakeJNDPCAResults<-GartersnakeJNDPCA$x[,1:4]

GartersnakePCA<-as.data.frame(GartersnakeJNDPCA$x) #create datasheet
GGchameleon2$SnakePC1<-GartersnakePCA$PC1 #add PC1 from Gartersnake PCA to datasheet
GGchameleon2$SnakePC2<-GartersnakePCA$PC2 #add PC1 from Gartersnake PCA to datasheet
```



Cranial Measurements & Bite Force:

GLM HL vs Bite Force (P = 2.2e-16)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=log.HL, y=log.bite)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  xlab("Head Length (Log mm)") +
  ylab("Maximum Bite Force (Log N)")+
  theme_bw()

biteHL.lm=lm(log.bite~log.HL, data=GGchameleon2)
#biteHL.lm=lm(log.bite~log.HL+log.SVL, data=GGchameleon2)
summary(biteHL.lm)
```



GLM HH vs Bite Force (P = 2.2e-16)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=log.HH, y=log.bite)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  xlab("Head Height (Log mm)") +
  ylab("Maximum Bite Force (Log N)")+
  theme_bw()

biteHH.lm=lm(log.bite~log.HH, data=GGchameleon2)
#biteHH.lm=lm(log.bite~log.HH+log.SVL, data=GGchameleon2)
summary(biteHH.lm)
```



GLM CH vs Bite Force (P = 1.29e-15)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=log.CH, y=log.bite)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  xlab("Casque Height (Log mm)") +
  ylab("Maximum Bite Force (Log N)")+
  theme_bw()

biteCH.lm=lm(log.bite~log.CH, data=GGchameleon2)
#biteCH.lm=lm(log.bite~log.CH+log.SVL, data=GGchameleon2)
summary(biteCH.lm)
```



GLM LJL vs Bite Force (P = 5.428e-15)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=log.LJL, y=log.bite)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  xlab("Lower Jaw Length (Log mm)") +
  ylab("Maximum Bite Force (Log N)")+
  theme_bw()

biteLJL.lm=lm(log.bite~log.LJL, data=GGchameleon2)
#biteLJL.lm=lm(log.bite~log.LJL+log.SVL, data=GGchameleon2)
summary(biteLJL.lm)
```



GLM HW vs Bite Force (P = 1.141e-15)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=log.HW, y=log.bite)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  xlab("Head Width (Log mm)") +
  ylab("Maximum Bite Force (Log N)")+
  theme_bw()

biteHW.lm=lm(log.bite~log.HW, data=GGchameleon2)
#biteHW.lm=lm(log.bite~log.HW+log.SVL, data=GGchameleon2)
summary(biteHW.lm)
```



GLM CW vs Bite Force (P = 6.719e-15)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=log.CW, y=log.bite)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  xlab("Casque Width (Log mm)") +
  ylab("Maximum Bite Force (Log N)")+
  theme_bw()

biteCW.lm=lm(log.bite~log.CW, data=GGchameleon2)
#biteCW.lm=lm(log.bite~log.CW+log.SVL, data=GGchameleon2)
summary(biteCW.lm)
```



GLM JW vs Bite Force (P= 1.664e-13)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=log.JW, y=log.bite)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  xlab("Jaw Width (Log mm)") +
  ylab("Maximum Bite Force (Log N)")+
  theme_bw()

biteJW.lm=lm(log.bite~log.JW, data=GGchameleon2)
#biteJW.lm=lm(log.bite~log.JW+log.SVL, data=GGchameleon2)
summary(biteJW.lm)
```



GLM SVL vs. maximum bite force (p=2.63e-16) (R^2 = 0.9391)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=log.SVL, y=log.bite)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  scale_x_continuous(name="Snout Vent Length (Log cm)",limits=c(1.09861228866811,3.218875824868201),breaks=c(1.09861228866811,1.386294361119891,1.6094379124341,1.945910149055313,2.302585092994046,2.70805020110221,2.995732273553991,3.218875824868201),expand=c(0,0)) +
  scale_y_continuous(name="Maximum Bite Force (Log N)",limits=c(-0.693147180559945,5),breaks=c(-0.693147180559945,0,0.693147180559945,1.6094379124341,2.70805020110221,3.401197381662155,3.912023005428146,4.31748811353631,4.828313737302301),expand=c(0,0))+
  theme_bw()
#ggsave("SVLvsBiteForce.pdf",useDingbats=FALSE)


biteSVL.lm=lm(log.bite~log.SVL, data=GGchameleon2)
summary(biteSVL.lm)
```



GLM SVL vs. peak velocity in cm (P = 0.003983, R^2 = 0.2678)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=SVL, y=peak.velocity.cm)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  scale_x_continuous(name="Snout Vent Length (cm)",limits=c(0,25),breaks=c(0,5,10,15,20,25),expand=c(0,0)) +
  scale_y_continuous(name="Peak Velocity\n(cm s-1)",limits=c(0,50),breaks=c(0,10,20,30,40,50),expand=c(0,0)) +
  theme_bw()
#ggsave("SVLvsNormVelocity.pdf",useDingbats=FALSE)

velocity.SVL.lm=lm(peak.velocity.cm~SVL, data=GGchameleon2)
summary(velocity.SVL.lm)
```



GLM SVL vs. peak velocity/body lengths (P = 2.193e-09, R^2 = 0.7719)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=SVL, y=normalized.peak.velocity)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  scale_x_continuous(name="Snout Vent Length (cm)",limits=c(0,25),breaks=c(0,5,10,15,20,25),expand=c(0,0)) +
  scale_y_continuous(name="Normalized Peak Velocity\n(body lengths s-1)",limits=c(0,5),breaks=c(0,1,2,3,4,5),expand=c(0,0)) +
  theme_bw()
#ggsave("SVLvsNormVelocity.pdf",useDingbats=FALSE)

normalized.SVL.lm=lm(normalized.peak.velocity~SVL, data=GGchameleon2)
summary(normalized.SVL.lm)
```



GLM SVL vs. Bird color space color change PC1 (p = 0.161, R^2 = 0.0418)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=SVL, y=BirdPC1)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  xlab("Snout Vent Length (cm)") +
  ylab("Maximum Color Difference in Bird Color Space (PC1)")+
  theme_bw()
birdcolor1.lm=lm(BirdPC1~SVL, data=GGchameleon2)
summary(birdcolor1.lm)
```



GLM SVL vs. Snake color space color change PC1 (P = 0.2600, R^2 = 0.01305)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=SVL, y=SnakePC1)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  xlab("Snout Vent Length (cm)") +
  ylab("Maximum Color Difference in Snake Color Space (PC1)")+
  theme_bw()
snakecolor1.lm=lm(SnakePC1~SVL, data=GGchameleon2)
summary(snakecolor1.lm)
```



GLM SVL vs. Snake color space color change PC2 (P = 0.1119, R^2 = 0.06451)
```{r}
library(ggplot2)
ggplot(GGchameleon2)
ggplot(GGchameleon2, aes(x=SVL, y=SnakePC2)) + 
  geom_point(color='black', size = 4, shape=21, fill='#5DBCD2') + 
  geom_smooth(method=lm, color='black') +
  xlab("Snout Vent Length (cm)") +
  ylab("Maximum Color Difference in Snake Color Space (PC2)")+
  theme_bw()
snakecolor2.lm=lm(SnakePC2~SVL, data=GGchameleon2)
summary(snakecolor2.lm)
```






************Mixed Models - Performance************


```{r}
library(nlme)
library(AICcmodavg)
library(MuMIn)
Behavior.Proportions.noA03=read.csv("Chameleon Behavior Proportions.csv")
attach(Behavior.Proportions.noA03)
bite.resid.model=lm(Behavior.Proportions.noA03$max.bite.force~Behavior.Proportions.noA03$SVL)
Behavior.Proportions.noA03$bite.resid=resid(bite.resid.model)
```

### AGGRESSION ### 
(m13) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid = 33.91332
(m14) Habitat + SVL + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid = 27.19991
(m15) Habitat + SVL + normalized.peak.velocity + BirdPC1 + SnakePC1 + bite.resid = 24.35992
(m16) Habitat + SVL + normalized.peak.velocity + BirdPC1 + bite.resid = 17.77497
(m17) Habitat + SVL + normalized.peak.velocity + bite.resid = 9.393533
*(m18) Habitat + SVL + bite.resid = 4.93903*
**(m19) SVL + bite.resid = 4.144424**
*(m20) Habitat + SVL = 5.869578*
(m21) Habitat + bite.resid = 8.833994
(m22) bite.resid = 8.084918
*(m23) SVL = 5.120503*
*(m24) Habitat - 5.285063*

```{r}
aggression.m1<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1 + Predator*SnakePC2 + Predator*bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m1)
aggression.m2<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1 + Predator*SnakePC2, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m2)
aggression.m3<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m3)
aggression.m4<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m4)
aggression.m5<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m5)
aggression.m6<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m6)
aggression.m7<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m7)
aggression.m8<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m8)
aggression.m9<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m9)
aggression.m10<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m10)
aggression.m11<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m11)
aggression.m12<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m12)
aggression.m13<-lme(prop.agg ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m13)
aggression.m14<-lme(prop.agg ~ Habitat + SVL + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m14)
aggression.m15<-lme(prop.agg ~ Habitat + SVL + normalized.peak.velocity + BirdPC1 + SnakePC1 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m15)
aggression.m16<-lme(prop.agg ~ Habitat + SVL + normalized.peak.velocity + BirdPC1 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m16)
aggression.m17<-lme(prop.agg ~ Habitat + SVL + normalized.peak.velocity + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m17)
aggression.m18<-lme(prop.agg ~ Habitat + SVL + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m18)
aggression.m19<-lme(prop.agg ~ SVL + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m19)
aggression.m20<-lme(prop.agg ~ Habitat + SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m20)
aggression.m21<-lme(prop.agg ~ Habitat + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m21)
aggression.m22<-lme(prop.agg ~bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m22)
aggression.m23<-lme(prop.agg ~ SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m23)
aggression.m24<-lme(prop.agg ~ Habitat, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(aggression.m24)

round(Weights(AICc(aggression.m1, aggression.m2, aggression.m3, aggression.m4, aggression.m5, aggression.m6, aggression.m7, aggression.m8, aggression.m9, aggression.m10, aggression.m11, aggression.m12, aggression.m13, aggression.m14, aggression.m15, aggression.m16, aggression.m17, aggression.m18, aggression.m19, aggression.m20, aggression.m21, aggression.m22, aggression.m23, aggression.m24)), 2)
```

##Figure with predicted estimates for aggression##
```{r}
library(ggplot2)
modpred<-predict(aggression.m18) #make predicted values of best fit model with all important variables
Behavior.Proportions.noA03$agg.m18.pred<-modpred #create variable in dataset with predicted values

ggplot(Behavior.Proportions.noA03, aes(x= bite.resid, y= agg.m18.pred, color= Habitat)) + geom_smooth(method = "glm") + #make plot as normal with original data; geom_point gives raw data points (add "+ geom_point()" to include raw data); geom_smooth uses predicted values to generate smooth line
  xlab("Relative Maximum Bite Force\n(Residuals)") +
  scale_x_continuous(limits=c(-40,60),breaks=c(-40,-20,0,20,40,60),expand=c(0,0))+
  ylab("Proportion Aggressive Response")+
  scale_y_continuous(limits=c(-0.25,1),breaks=c(-0.25,0.0,0.25,0.5,0.75,1.0),expand=c(0,0)) +
  theme_bw()

#ggsave("RelativeBiteForcevsPropAggression_Fit_2.pdf",useDingbats=FALSE)

#make plot as normal with original data; geom_point gives raw data points; geom_smooth uses predicted values to generate smooth line

ggplot(Behavior.Proportions.noA03, aes(x= SVL, y= agg.m18.pred, color= Habitat)) + geom_smooth(method = "glm") + #make plot as normal with original data; geom_point gives raw data points(add "+ geom_point()" to include raw data); geom_smooth uses predicted values to generate smooth line
  xlab("Snout-vent Length (cm)") +
  scale_x_continuous(limits=c(0,25),breaks=c(0,5,10,15,20,25),expand=c(0,0))+
  ylab("Proportion Aggressive Response")+
  scale_y_continuous(limits=c(-0.25,1),breaks=c(-0.25,0.0,0.25,0.5,0.75,1.0),expand=c(0,0)) +
  theme_bw()

#ggsave("SVLvsPropAggression_Fit.pdf",useDingbats=FALSE)
```



### FLEEING ###
(m1) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 + Predator x SnakePC2 + Predator x bite.resid = 212.3864
(m2) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 + Predator x SnakePC2 = 199.7957
(m3) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 = 192.534
(m4) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 = 186.5288
(m5) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity = 179.2569
(m6) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL = 173.6968
(m7) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid = 163.1563
(m8) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 = 150.9039
(m9) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 = 145.3743
(m10) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 = 139.3583
(m11) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity = 134.1901
(m12) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL = 129.1135
(m13) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid = 122.3801
(m14) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + bite.resid = 115.2641
(m15) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + bite.resid = 109.669
(m16) Habitat + SVL + Predator + normalized.peak.velocity + bite.resid = 101.6995
(m17) Habitat + SVL + normalized.peak.velocity + bite.resid = 95.53222
(m18) Habitat + SVL + normalized.peak.velocity = 85.47369
**(m19) Habitat + normalized.peak.velocity = 79.13935**
(m20) Habitat = 86.39515
(m21) normalized.peak.velocity = 81.36988

```{r}
fleeing.m1<-lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1 + Predator*SnakePC2 + Predator*bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m1)
fleeing.m2<-lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1 + Predator*SnakePC2, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m2)
fleeing.m3<-lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m3)
fleeing.m4<-lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m4)
fleeing.m5<-lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m5)
fleeing.m6<-lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m6)
fleeing.m7<-lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m7)
fleeing.m8<-lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m8)
fleeing.m9<-lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m9)
fleeing.m10<-lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m10)
fleeing.m11<-lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m11)
fleeing.m12<-lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m12)
fleeing.m13=lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m13)
fleeing.m14=lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m14)
fleeing.m15=lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m15)
fleeing.m16=lme(prop.flee ~ Habitat + SVL + Predator + normalized.peak.velocity + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m16)
fleeing.m17=lme(prop.flee ~ Habitat + SVL + normalized.peak.velocity + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m17)
fleeing.m18=lme(prop.flee ~ Habitat + SVL + normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m18)
fleeing.m19=lme(prop.flee ~ Habitat + normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m19)
fleeing.m20=lme(prop.flee ~ Habitat, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m20)
fleeing.m21=lme(prop.flee ~ normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(fleeing.m21)

round(Weights(AICc(fleeing.m1, fleeing.m2, fleeing.m3, fleeing.m4, fleeing.m5, fleeing.m6, fleeing.m7, fleeing.m8, fleeing.m9, fleeing.m10, fleeing.m11, fleeing.m12, fleeing.m13, fleeing.m14, fleeing.m15, fleeing.m16, fleeing.m17, fleeing.m18, fleeing.m19, fleeing.m20, fleeing.m21)), 2)
```


##Figure with predicted estimates for fleeing##
```{r}
library(ggplot2)
library(mgcv)
library(tidymv)


modpred<-predict(fleeing.m19) #make predicted values of best fit model with all important variables
Behavior.Proportions.noA03$flee.m19.pred<-modpred #create variable in dataset with predicted values

ggplot(Behavior.Proportions.noA03, aes(x= normalized.peak.velocity, y= flee.m19.pred, color= Habitat)) + geom_smooth(method = "glm") + #make plot as normal with original data; geom_point gives raw data points(add "+ geom_point()" to include raw data); geom_smooth uses predicted values to generate smooth line
  xlab("Normalized Peak Velocity\n(body lengths s-1)") +
  scale_x_continuous(limits=c(0,5),breaks=c(0,1,2,3,4,50),expand=c(0,0))+
  ylab("Proportion Fleeing Response")+
  scale_y_continuous(limits=c(-0.25,1),breaks=c(-0.25,0.0,0.25,0.5,0.75,1.0),expand=c(0,0)) +
  theme_bw()

#ggsave("NormalizedVelocityvsPropFlee_Fit.pdf",useDingbats=FALSE)
```



### CRYPSIS ###
(m1) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 + Predator x SnakePC2 + Predator x bite.resid = 84.52959
(m2) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 + Predator x SnakePC2 = 70.33055
(m3) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 = 61.72659
(m4) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 = 53.75883
(m5) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity = 46.85451
(m6) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL = 39.95182
(m7) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid = 30.40554
(m8) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 = 16.91234
(m9) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 = 8.45487
(m10) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 = 0.882697
(m11) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x BirdPC1 = -5.722068
(m12) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x BirdPC1 = -13.51074
(m13) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + Habitat x BirdPC1 = -27.60437
(m14) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + Habitat x BirdPC1 = -36.48698
(m15) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + Habitat x BirdPC1 = -44.55068
(m16) Habitat + SVL + normalized.peak.velocity + BirdPC1 + Habitat x BirdPC1 = -50.77719
(m17) Habitat + SVL + BirdPC1 + Habitat x BirdPC1 = -57.98331
**(m18) Habitat + BirdPC1 + Habitat x BirdPC1 = -67.7464**
(m19) Habitat + BirdPC1 = -59.24752
**(m20) Habitat + Habitat x BirdPC1 = -67.7464**
**(m21) BirdPC1 + Habitat x BirdPC1 = -67.7464**
(m22) Habitat = -60.32939
(m23) BirdPC1 = -57.75672
**(m24) Habitat x BirdPC1 = -67.7464**


```{r}
crypsis.m1<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1 + Predator*SnakePC2 + Predator*bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m1)
crypsis.m2<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1 + Predator*SnakePC2, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m2)
crypsis.m3<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m3)
crypsis.m4<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m4)
crypsis.m5<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m5)
crypsis.m6<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m6)
crypsis.m7<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m7)
crypsis.m8<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m8)
crypsis.m9<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m9)
crypsis.m10<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m10)
crypsis.m11<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m11)
crypsis.m12<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m12)
crypsis.m13<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m13)
crypsis.m14<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m14)
crypsis.m15<-lme(prop.crypsis ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m15)
crypsis.m16<-lme(prop.crypsis ~ Habitat + SVL + normalized.peak.velocity + BirdPC1 + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m16)
crypsis.m17<-lme(prop.crypsis ~ Habitat + SVL + BirdPC1 + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m17)
crypsis.m18<-lme(prop.crypsis ~ Habitat + BirdPC1 + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m18)
crypsis.m19<-lme(prop.crypsis ~ Habitat + BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m19)
crypsis.m20<-lme(prop.crypsis ~ Habitat + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m20)
crypsis.m21<-lme(prop.crypsis ~ BirdPC1 + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m21)
crypsis.m22<-lme(prop.crypsis ~ Habitat, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m22)
crypsis.m23<-lme(prop.crypsis ~ BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m23)
crypsis.m24<-lme(prop.crypsis ~ Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(crypsis.m24)

round(Weights(AICc(crypsis.m1, crypsis.m2, crypsis.m3, crypsis.m4, crypsis.m5, crypsis.m6, crypsis.m7, crypsis.m8, crypsis.m9, crypsis.m10, crypsis.m11, crypsis.m12, crypsis.m13, crypsis.m14, crypsis.m15, crypsis.m16, crypsis.m17, crypsis.m18, crypsis.m19, crypsis.m20, crypsis.m21, crypsis.m22, crypsis.m23, crypsis.m24)), 2)
```

##Figure with predicted estimates for crypsis##
```{r}
library(ggplot2)
library(mgcv)
library(tidymv)


modpred<-predict(crypsis.m18) #make predicted values of best fit model with all important variables
Behavior.Proportions.noA03$cryp.m18.pred<-modpred #create variable in dataset with predicted values

ggplot(Behavior.Proportions.noA03, aes(x= BirdPC1, y= cryp.m18.pred, color= Habitat)) + geom_smooth(method = "glm")  + #make plot as normal with original data; geom_point gives raw data points(add "+ geom_point()" to include raw data); geom_smooth uses predicted values to generate smooth line
  xlab("Color Change in Bird Color Space\n(BirdPC1)") +
  scale_x_continuous(limits=c(-2.5,7.5),breaks=c(-2.5,0.0,2.5,5.0,7.5),expand=c(0,0))+
  ylab("Proportion Crypsis Response")+
  scale_y_continuous(limits=c(-0.25,1),breaks=c(-0.25,0.0,0.25,0.5,0.75,1.0),expand=c(0,0)) +
  theme_bw()

#ggsave("BirdPC1vsPropCrypsis_Fit.pdf",useDingbats=FALSE)
```



### RINGFLIP ###
(m1) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 + Predator x SnakePC2 + Predator x bite.resid = 138.965
(m2) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 + Predator x SnakePC2 = 125.8169
(m3) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 = 121.6122
(m4) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 = 114.8384
(m5) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity = 106.6244
(m6) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL = 100.7389
(m7) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid = 90.46881
(m8) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 = 77.6281
(m9) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 = 70.06682
(m10) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 = 64.30434
(m11) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity = 57.68379
(m12) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x normalized.peak.velocity = 48.6582
(m13) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + Habitat x normalized.peak.velocity = 35.11413
(m14) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + Habitat x normalized.peak.velocity = 26.52188
(m15) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + Habitat x normalized.peak.velocity = 19.22923
(m16) Habitat + SVL + Predator + normalized.peak.velocity + Habitat x normalized.peak.velocity = 12.23305
(m17) Habitat + SVL + normalized.peak.velocity + Habitat x normalized.peak.velocity = 5.351966
**(m18) Habitat + normalized.peak.velocity + Habitat x normalized.peak.velocity = -4.017515**
(m19) Habitat + normalized.peak.velocity = 7.59042
**(m20) Habitat + Habitat x normalized.peak.velocity = -4.017515**
**(m21) normalized.peak.velocity + Habitat x normalized.peak.velocity = -4.017515**
(m22) Habitat = 13.12299
(m23) normalized.peak.velocity = 31.30244
**(m24) Habitat x normalized.peak.velocity = -4.017515**

```{r}
ring.m1<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1 + Predator*SnakePC2 + Predator*bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m1)
ring.m2<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1 + Predator*SnakePC2, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m2)
ring.m3<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m3)
ring.m4<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m4)
ring.m5<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m5)
ring.m6<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m6)
ring.m7<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m7)
ring.m8<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m8)
ring.m9<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m9)
ring.m10<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m10)
ring.m11<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m11)
ring.m12<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m12)
ring.m13<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m13)
ring.m14<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m14)
ring.m15<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m15)
ring.m16<-lme(prop.ring ~ Habitat + SVL + Predator + normalized.peak.velocity + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m16)
ring.m17<-lme(prop.ring ~ Habitat + SVL + normalized.peak.velocity + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m17)
ring.m18<-lme(prop.ring ~ Habitat + normalized.peak.velocity + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m18)
ring.m19<-lme(prop.ring ~ Habitat + normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m19)
ring.m20<-lme(prop.ring ~ Habitat + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m20)
ring.m21<-lme(prop.ring ~ normalized.peak.velocity + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m21)
ring.m22<-lme(prop.ring ~ Habitat, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m22)
ring.m23<-lme(prop.ring ~ normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m23)
ring.m24<-lme(prop.ring ~ Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(ring.m24)

round(Weights(AICc(ring.m1, ring.m2, ring.m3, ring.m4, ring.m5, ring.m6, ring.m7, ring.m8, ring.m9, ring.m10, ring.m11, ring.m12, ring.m13, ring.m14, ring.m15, ring.m16, ring.m17, ring.m18, ring.m19, ring.m20, ring.m21, ring.m22, ring.m23, ring.m24)), 2)
```

##Figure with predicted estimates for ringflip##
```{r}
library(ggplot2)
library(mgcv)
library(tidymv)


modpred<-predict(ring.m18) #make predicted values of best fit model with all important variables
Behavior.Proportions.noA03$ring.m18.pred<-modpred #create variable in dataset with predicted values

ggplot(Behavior.Proportions.noA03, aes(x= normalized.peak.velocity, y= ring.m18.pred, color= Habitat)) + geom_smooth(method = "glm")  + #make plot as normal with original data; geom_point gives raw data points(add "+ geom_point()" to include raw data); geom_smooth uses predicted values to generate smooth line
  xlab("Normalized Peak Velocity\n(body lengths s-1)") +
  scale_x_continuous(limits=c(0,5),breaks=c(0,1,2,3,4,50),expand=c(0,0))+
  ylab("Proportion Ring-flip Response")+
  scale_y_continuous(limits=c(-0.25,1),breaks=c(-0.25,0.0,0.25,0.5,0.75,1.0),expand=c(0,0)) +
  theme_bw()

#ggsave("NormalizedVelocityvsPropRingflip_Fit.pdf",useDingbats=FALSE)
```



### DROP ###
(m1) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 + Predator x SnakePC2 + Predator x bite.resid = -117.3342
(m2) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 + Predator x SnakePC2 = -133.8403
(m3) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 = -144.8872
(m4) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 = -155.1243
(m5) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity = -167.0594
(m6) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL = -176.1595
(m7) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid = -188.5617
(m8) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 = -204.5236
(m9) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 = -214.7674
(m10) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 = -224.6426
(m11) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity = -236.241
(m12) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL = -245.1553
(m13) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid = -257.6866
(m14) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + bite.resid = -269.0679
(m15) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + bite.resid = -279.9637
(m16) Habitat + SVL + Predator + normalized.peak.velocity + bite.resid = -292.6628
(m17) Habitat + SVL + normalized.peak.velocity + bite.resid = -302.4345
(m18) Habitat + SVL + normalized.peak.velocity = -319.2721
(m19) Habitat + SVL = -329.2297
**(m20) Habitat = -342.784**

```{r}
drop.m1<-lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1 + Predator*SnakePC2 + Predator*bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m1)
drop.m2<-lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1 + Predator*SnakePC2, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m2)
drop.m3<-lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m3)
drop.m4<-lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m4)
drop.m5<-lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m5)
drop.m6<-lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m6)
drop.m7<-lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m7)
drop.m8<-lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m8)
drop.m9<-lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m9)
drop.m10<-lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m10)
drop.m11<-lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m11)
drop.m12<-lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m12)
drop.m13=lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m13)
drop.m14=lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m14)
drop.m15=lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m15)
drop.m16=lme(prop.drop ~ Habitat + SVL + Predator + normalized.peak.velocity + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m16)
drop.m17=lme(prop.drop ~ Habitat + SVL + normalized.peak.velocity + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m17)
drop.m18=lme(prop.drop ~ Habitat + SVL + normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m18)
drop.m19=lme(prop.drop ~ Habitat + SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m19)
drop.m20=lme(prop.drop ~ Habitat, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(drop.m20)

round(Weights(AICc(drop.m1, drop.m2, drop.m3, drop.m4, drop.m5, drop.m6, drop.m7, drop.m8, drop.m9, drop.m10, drop.m11, drop.m12, drop.m13, drop.m14, drop.m15, drop.m16, drop.m17, drop.m18, drop.m19, drop.m20)), 2)
```

### LEAF ###
(m1) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 + Predator x SnakePC2 + Predator x bite.resid = -79.84921
(m2) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 + Predator x SnakePC2 = -95.71509
(m3) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 + Predator x SnakePC1 = -105.9849
(m4) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity + Predator x BirdPC1 = -115.0768
(m5) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL + Predator x normalized.peak.velocity = -126.158
(m6) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid + Predator x SVL = -134.2074
(m7) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 + Habitat x bite.resid = -146.2638
(m8) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 + Habitat x SnakePC2 = -161.7047
(m9) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 + Habitat x SnakePC1 = -171.5592
(m10) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity + Habitat x BirdPC1 = -180.244
(m11) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL + Habitat x normalized.peak.velocity = -190.9379
(m12) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat x SVL = -198.6048
(m13) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid = -210.2722
(m14) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + bite.resid = -221.2687
(m15) Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + bite.resid = -231.1831
(m16) Habitat + SVL + Predator + normalized.peak.velocity + bite.resid = -242.9214
(m17) Habitat + SVL + normalized.peak.velocity + bite.resid = -250.6804
(m18) Habitat + SVL + normalized.peak.velocity = -266.8125
(m19) Habitat + SVL = -275.5026
**(m20) Habitat = -288.2119**

```{r}
leaf.m1<-lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1 + Predator*SnakePC2 + Predator*bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m1)
leaf.m2<-lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1 + Predator*SnakePC2, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m2)
leaf.m3<-lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1 + Predator*SnakePC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m3)
leaf.m4<-lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity + Predator*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m4)
leaf.m5<-lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL + Predator*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m5)
leaf.m6<-lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid + Predator*SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m6)
leaf.m7<-lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2 + Habitat*bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m7)
leaf.m8<-lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1 + Habitat*SnakePC2, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m8)
leaf.m9<-lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1 + Habitat*SnakePC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m9)
leaf.m10<-lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity + Habitat*BirdPC1, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m10)
leaf.m11<-lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL + Habitat*normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m11)
leaf.m12<-lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid + Habitat*SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m12)
leaf.m13=lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + SnakePC2 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m13)
leaf.m14=lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + SnakePC1 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m14)
leaf.m15=lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + BirdPC1 + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m15)
leaf.m16=lme(prop.leaf ~ Habitat + SVL + Predator + normalized.peak.velocity + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m16)
leaf.m17=lme(prop.leaf ~ Habitat + SVL + normalized.peak.velocity + bite.resid, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m17)
leaf.m18=lme(prop.leaf ~ Habitat + SVL + normalized.peak.velocity, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m18)
leaf.m19=lme(prop.leaf ~ Habitat + SVL, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m19)
leaf.m20=lme(prop.leaf ~ Habitat, random=~1|Individual, data=Behavior.Proportions.noA03)
AICc(leaf.m20)

round(Weights(AICc(leaf.m1, leaf.m2, leaf.m3, leaf.m4, leaf.m5, leaf.m6, leaf.m7, leaf.m8, leaf.m9, leaf.m10, leaf.m11, leaf.m12, leaf.m13, leaf.m14, leaf.m15, leaf.m16, leaf.m17, leaf.m18, leaf.m19, leaf.m20)), 2)
```







